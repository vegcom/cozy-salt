# Hardened SSH configuration for production Windows
# Deployed by Salt - cozy-salt project

# Authentication
PasswordAuthentication no
PubkeyAuthentication yes
PermitRootLogin no
PermitEmptyPasswords no

# Security - Windows OpenSSH specific
# ChallengeResponseAuthentication is deprecated, use KbdInteractiveAuthentication
KbdInteractiveAuthentication no
PubkeyAcceptedKeyTypes ssh-ed25519,ssh-rsa,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521

# Session limits
MaxAuthTries 3
MaxSessions 10

# Windows-specific: Administrators group authorization
# Comment this out if you want to use standard authorized_keys
# Match Group administrators
#        AuthorizedKeysFile __PROGRAMDATA__/ssh/administrators_authorized_keys
